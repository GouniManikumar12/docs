---
title: "Citation & Product Format"
description: "Display recommendations as inline citations or product cards with automatic tracking"
---

The **Citation & Product Format** uses the AdMesh UI SDK to automatically render recommendations with built-in tracking, labeling, and transparency.

This is the **easiest integration** if you want AdMesh to handle all rendering and tracking automatically.

## Quick Start

<Steps>
  <Step title="Install the SDK">
    ```bash
    npm install admesh-ui-sdk
    ```
  </Step>
  <Step title="Initialize the SDK">
    ```tsx
    import { AdMeshSDK } from 'admesh-ui-sdk';

    const admesh = new AdMeshSDK({
      apiKey: process.env.REACT_APP_ADMESH_API_KEY,
      debug: false
    });
    ```
  </Step>
  <Step title="Add Container">
    ```html
    <div id="admesh-recommendations"></div>
    ```
  </Step>
  <Step title="Render Recommendations">
    ```tsx
    // SDK handles session management automatically
    await admesh.showRecommendations({
      query: 'best project management tools',
      containerId: 'admesh-recommendations',
      format: 'citation'
    });
    ```
  </Step>
</Steps>

---

## Format Types

### Citation Format
Displays LLM-generated summary with embedded product links. Perfect for AI assistants and conversational interfaces.

```tsx
await admesh.showRecommendations({
  query: 'best project management tools',
  containerId: 'admesh-recommendations',
  format: 'citation'
});
```

**Output:**
```
"Consider [HubSpot](url) for CRM needs or [Asana](url) for project management."
```

### Product Format
Displays individual product recommendation cards with details. Ideal for SaaS and software recommendations.

```tsx
await admesh.showRecommendations({
  query: 'best CRM software',
  containerId: 'admesh-recommendations',
  format: 'product'
});
```

### Ecommerce Format
Displays product cards optimized for ecommerce recommendations. Perfect for shopping and physical products.

```tsx
await admesh.showRecommendations({
  query: 'laptop under 1000',
  containerId: 'admesh-recommendations',
  format: 'ecommerce'
});
```

### Auto Format
Automatically selects the best layout based on content type.

```tsx
await admesh.showRecommendations({
  query: 'best tools',
  containerId: 'admesh-recommendations',
  format: 'auto'
});
```

---

## Session Management

The SDK handles session management automatically, but you can also control it manually:

```tsx
import { AdMeshSDK } from 'admesh-ui-sdk';

const admesh = new AdMeshSDK({
  apiKey: process.env.REACT_APP_ADMESH_API_KEY
});

// Get current session ID (auto-created on first use)
const sessionId = admesh.getSessionId();

// Create a new session (e.g., for a new conversation)
const newSessionId = admesh.createNewSession();

// Set a custom session ID
admesh.setSessionId('custom-session-id');

// Close session when done
admesh.closeSession();
```

---

## Customization

### Theme Customization

```tsx
import {
  AdMeshSDK,
  mergeTheme,
  injectCustomTheme
} from 'admesh-ui-sdk';

// Create custom theme
const theme = mergeTheme({
  mode: 'dark',
  primaryColor: '#3b82f6',
  accentColor: '#ffffff',
  borderRadius: '0.5rem'
});

// Inject globally
injectCustomTheme(theme);

// Initialize SDK (theme automatically applied)
const admesh = new AdMeshSDK({
  apiKey: process.env.REACT_APP_ADMESH_API_KEY
});
```

### Event Handlers

```tsx
await admesh.showRecommendations({
  query: 'best tools',
  containerId: 'admesh-recommendations',
  format: 'citation',
  onRecommendationClick: (recommendation) => {
    console.log('User clicked:', recommendation.title);
  },
  onLinkClick: (url) => {
    console.log('User clicked link:', url);
  }
});
```

---

## Automatic Tracking

The SDK automatically handles all tracking:

1. **Exposure pixels** fire when recommendations are rendered
2. **Click tracking** fires when users interact with recommendations
3. **Conversion tracking** if configured
4. **Transparency labels** (`[Ad]`) are added automatically

No additional code needed! The SDK manages everything internally.

---

## Complete Integration Example

Here's a complete end-to-end example in React:

```tsx
import React, { useState, useEffect } from 'react';
import { AdMeshSDK } from 'admesh-ui-sdk';

function ChatWithRecommendations() {
  const [query, setQuery] = useState('');
  const [admesh, setAdmesh] = useState<AdMeshSDK | null>(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  // Initialize SDK once on mount
  useEffect(() => {
    const sdk = new AdMeshSDK({
      apiKey: process.env.REACT_APP_ADMESH_API_KEY,
      debug: false
    });
    setAdmesh(sdk);

    // Cleanup: close session when component unmounts
    return () => {
      sdk.closeSession();
    };
  }, []);

  const showRecommendations = async () => {
    if (!query.trim() || !admesh) return;

    setLoading(true);
    setError(null);

    try {
      // SDK automatically handles session management and tracking
      await admesh.showRecommendations({
        query,
        containerId: 'admesh-recommendations',
        format: 'citation'
      });
    } catch (err) {
      console.error('Failed to render recommendations:', err);
      setError('Failed to load recommendations. Please try again.');
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="chat-container">
      <div className="chat-input">
        <input
          type="text"
          value={query}
          onChange={(e) => setQuery(e.target.value)}
          onKeyPress={(e) => e.key === 'Enter' && showRecommendations()}
          placeholder="Ask for product recommendations..."
          disabled={loading || !admesh}
        />
        <button
          onClick={showRecommendations}
          disabled={loading || !query.trim() || !admesh}
        >
          {loading ? 'Loading...' : 'Get Recommendations'}
        </button>
      </div>

      {error && (
        <div className="error-message">
          {error}
        </div>
      )}

      <div id="admesh-recommendations" />
    </div>
  );
}

export default ChatWithRecommendations;
```

---

## Best Practices

✅ **DO:**
- Use the SDK for quick, reliable integration
- Let the SDK handle rendering and tracking automatically
- Customize theme to match your brand
- Test with different format types (citation, product, ecommerce)
- Create a new session for each conversation or search thread
- Enable debug mode during development

❌ **DON'T:**
- Manually fire exposure pixels (SDK does this automatically)
- Modify or remove transparency labels
- Render recommendations outside the SDK container
- Manually manage session creation/closing (SDK handles this)
- Reuse session IDs across different conversations

---

## Troubleshooting

<AccordionGroup>
  <Accordion title="Recommendations Not Showing">
    **Common causes:**
    - Container element not found
    - API key not configured
    - Invalid query

    **Solutions:**
    ```tsx
    // Enable debug mode to see detailed logs
    const admesh = new AdMeshSDK({
      apiKey: process.env.REACT_APP_ADMESH_API_KEY,
      debug: true
    });

    // Verify container exists
    const container = document.getElementById('admesh-recommendations');
    if (!container) {
      console.error('Container element not found');
    }

    // Check session ID
    console.log('Session ID:', admesh.getSessionId());
    ```
  </Accordion>

  <Accordion title="API Key Issues">
    **Common causes:**
    - Missing API key
    - Invalid API key format
    - API key not passed correctly

    **Solutions:**
    ```tsx
    // Verify API key is set
    const apiKey = process.env.REACT_APP_ADMESH_API_KEY;
    if (!apiKey) {
      console.error('REACT_APP_ADMESH_API_KEY not set');
    }

    // Check API key format
    if (!apiKey.startsWith('admesh_')) {
      console.error('Invalid API key format');
    }

    // Initialize with valid key
    const admesh = new AdMeshSDK({
      apiKey: apiKey,
      apiBaseUrl: 'https://api.useadmesh.com'
    });
    ```
  </Accordion>

  <Accordion title="Tracking Not Working">
    **Important:** The SDK handles all tracking automatically. You should NOT:
    - Manually fire exposure pixels
    - Modify tracking URLs
    - Remove transparency labels

    If tracking isn't working:
    ```tsx
    // Enable debug mode to see tracking events
    const admesh = new AdMeshSDK({
      apiKey: process.env.REACT_APP_ADMESH_API_KEY,
      debug: true
    });

    // Check browser console for tracking logs
    // Verify network requests in DevTools Network tab
    ```
  </Accordion>

  <Accordion title="Session Management Issues">
    **Common causes:**
    - Session creation failed
    - Session expired
    - Multiple SDK instances

    **Solutions:**
    ```tsx
    // Create single SDK instance (not multiple)
    const admesh = new AdMeshSDK({
      apiKey: process.env.REACT_APP_ADMESH_API_KEY
    });

    // SDK automatically creates session on first use
    const sessionId = admesh.getSessionId();

    // Create new session for new conversation
    const newSessionId = admesh.createNewSession();

    // Close session when done
    admesh.closeSession();
    ```
  </Accordion>
</AccordionGroup>

---

## Next Steps

<CardGroup cols={2}>
  <Card title="Installation Guide" icon="download" href="/ui-sdk/installation">
    Complete SDK installation and setup
  </Card>
  <Card title="API Reference" icon="book" href="/api/recommendations">
    Complete API documentation
  </Card>
</CardGroup>

