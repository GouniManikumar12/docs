---
title: "Hooks"
description: "React hooks for AdMesh recommendations and tracking"
---

# React Hooks

The AdMesh React SDK provides powerful hooks for fetching recommendations and tracking viewability metrics.

## useRecommendations

Fetch recommendations from the AdMesh API with automatic loading and error handling.

### Usage

```tsx
import { useRecommendations } from '@admesh/react-sdk';

function MyComponent() {
  const { recommendations, loading, error, refetch } = useRecommendations({
    query: 'laptop under $1000',
    limit: 5,
    category: 'electronics',
    enabled: true
  });

  if (loading) return <div>Loading...</div>;
  if (error) return <div>Error: {error.message}</div>;

  return (
    <div>
      {recommendations.map((rec) => (
        <div key={rec.id}>{rec.title}</div>
      ))}
      <button onClick={refetch}>Refresh</button>
    </div>
  );
}
```

### Options

| Option | Type | Required | Description |
|--------|------|----------|-------------|
| `query` | string | Yes | Search query for recommendations |
| `limit` | number | No | Maximum number of recommendations (default: 5) |
| `category` | string | No | Filter by category |
| `maxPrice` | number | No | Maximum price filter |
| `minRating` | number | No | Minimum rating filter |
| `enabled` | boolean | No | Enable/disable fetching (default: true) |

### Return Value

```tsx
{
  recommendations: Recommendation[];
  loading: boolean;
  error: Error | null;
  refetch: () => Promise<void>;
}
```

## useViewabilityTracker

Track MRC-compliant viewability metrics for recommendations using Intersection Observer.

### Usage

```tsx
import { useViewabilityTracker } from '@admesh/react-sdk';

function RecommendationCard() {
  const { ref, isVisible, metrics } = useViewabilityTracker({
    threshold: 50,
    duration: 1000,
    onVisible: (metrics) => {
      console.log('Element is viewable:', metrics);
      // Track exposure event
    }
  });

  return (
    <div ref={ref}>
      {isVisible && <span>Visible</span>}
      {metrics && <span>Score: {metrics.score}%</span>}
    </div>
  );
}
```

### Options

| Option | Type | Required | Description |
|--------|------|----------|-------------|
| `threshold` | number | No | Visibility percentage (0-100, default: 50) |
| `duration` | number | No | Duration in ms (default: 1000) |
| `onVisible` | function | No | Callback when element becomes viewable |

### Return Value

```tsx
{
  ref: React.RefObject<HTMLDivElement>;
  isVisible: boolean;
  metrics: ViewabilityMetrics | null;
}
```

### ViewabilityMetrics

```tsx
interface ViewabilityMetrics {
  score: number;              // Visibility percentage (0-100)
  duration: number;           // Time visible in milliseconds
  timestamp: number;          // When metrics were recorded
  intersection_ratio_peak: number;    // Peak visibility ratio
  exposure_start_timestamp: number;   // When element became visible
  exposure_end_timestamp: number;     // When element became invisible
  mrc_compliant: boolean;     // ≥50% visible for ≥1000ms
}
```

## useAdMesh

Access the AdMesh context directly for advanced use cases.

### Usage

```tsx
import { useAdMesh } from '@admesh/react-sdk';

function MyComponent() {
  const { apiKey, apiBaseUrl, debug, fetchRecommendations, trackEvent } = useAdMesh();

  // Use context values
  console.log('API Base URL:', apiBaseUrl);
}
```

### Return Value

```tsx
{
  apiKey: string;
  apiBaseUrl: string;
  viewabilityConfig: ViewabilityConfig;
  debug: boolean;
  fetchRecommendations: (query: RecommendationQuery) => Promise<Recommendation[]>;
  trackEvent: (event: TrackingEvent) => Promise<void>;
}
```

## useAnalytics

Track analytics events and calculate performance metrics.

### Usage

```tsx
import { useAnalytics } from '@admesh/react-sdk';

function MyComponent() {
  const { trackExposure, trackClick, trackConversion, getMetrics } = useAnalytics();

  const handleClick = async () => {
    await trackClick({ ad_id: '123', session_id: 'abc' });
  };

  return <button onClick={handleClick}>Click Me</button>;
}
```

## Best Practices

1. **Memoize Components** - Use `React.memo()` to prevent unnecessary re-renders
2. **Handle Loading States** - Always check `loading` before rendering
3. **Error Handling** - Implement proper error boundaries
4. **Viewability Tracking** - Always wrap recommendations with viewability tracker
5. **Cleanup** - Hooks automatically clean up resources on unmount

## Next Steps

- [View components](/react-sdk/components)
- [Check examples](/react-sdk/examples)
- [API reference](/react-sdk/api-reference)

